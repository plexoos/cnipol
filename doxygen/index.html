<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>cnipol: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cnipol
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cnipol Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/rhicspin/cnipol">![Build Status](https://travis-ci.org/rhicspin/cnipol.svg?branch=master)</a></p>
<p><b>Table of Contents</b></p>
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#general-remarks">General remarks</a></li>
</ul>
</li>
<li><a href="#how-to-configure-and-install-cnipol">How to configure and install cnipol</a></li>
<li><a href="#how-to-run-cnipol">How to run cnipol</a><ul>
<li><a href="#batch-processing-multiple-data-files">Batch processing multiple data files</a></li>
</ul>
</li>
<li><a href="#how-to-produce-summary-plots">How to produce summary plots</a></li>
<li><a href="#other-software-packages-for-the-rhic-polarimetry">Other software packages for the RHIC polarimetry</a></li>
</ul>
<h1>Introduction </h1>
<p><b>cnipol</b> is a software package designed to acquire and analyze data from the Relativistic Heavy Ion Collider (RHIC) polarimeters at the Brookhaven National Lab (BNL). The first objective of this package is usually referred to as the "online" layer and designed to support the data acquisition and to provide a quick feedback by carrying a fast online analysis. The second objective is to execute a more rigorous "offline" data analysis and present the results in a systematic way. It is normally referred to as the "offline" layer of <b>cnipol</b>.</p>
<p>There is a wiki page with some details about the RHIC polarimetry:</p>
<p><a href="https://wiki.bnl.gov/rhicspin/Polarimetry">https://wiki.bnl.gov/rhicspin/Polarimetry</a></p>
<p>The entry page with links to results obtained with cnipol can be found at</p>
<p><a href="http://www.phy.bnl.gov/cnipol/">http://www.phy.bnl.gov/cnipol/</a></p>
<h2>General remarks </h2>
<p>The code for the analysis of the RHIC polarimeters data has changed significantly starting 2010. Nevertheless, one may still find it useful to look through the older documentation which can be found at</p>
<p><a href="http://www4.rcf.bnl.gov/~cnipol/Analysis/pC/index.html">http://www4.rcf.bnl.gov/~cnipol/Analysis/pC/index.html</a></p>
<h1>How to configure and install cnipol </h1>
<p>The best way to start with the analysis is to clone the latest version of the code from the git repository. From the location where the package will be installed on your machine issue the following command: </p>
<pre class="fragment">git clone https://github.com/rhicspin/cnipol.git
cd cnipol
</pre><p>If you plan to push changes back to the repository a github account is required. The source code in this case can be cloned via ssh protocol: </p>
<pre class="fragment">git clone git@github.com:rhicspin/cnipol.git
cd cnipol
</pre><p>To make the processing of the data controllable and predictable we create stable releases of the code. The list of tagged stable releases can be viewed at <a href="https://github.com/rhicspin/cnipol/releases">https://github.com/rhicspin/cnipol/releases</a> One may switch from the development version of the code checked out as above to the latest stable release by issuing the following command: </p>
<pre class="fragment">git checkout stable
</pre><p>The analysis framework depends on a few external libraries and programs including</p>
<ul>
<li>ROOT</li>
<li>MySQL</li>
</ul>
<p>The data acquisition and online processing code depends on CERNLIB and CDEV.</p>
<p>Before the code can be compiled and executed a number of environment variables must be set. We provide an example bash script <code>script/setup.sh</code> with predefined paths which should work on the eic cluster of the RACF (RHIC and ATLAS Computing Facility). Review and modify this script as needed to match your specific system configuration. This script can be ran with an optional argument for the RHIC run number, e.g. <code>run_id = 9|11|12|13</code>, execute in the terminal: </p>
<pre class="fragment">source script/setup.sh [run_id]
</pre><p>Once the environment variables are set the cnipol package can be build in $CNIPOL_DIR as: </p>
<pre class="fragment">mkdir build
cd build
cmake .. -DCMAKE_BUILD_TYPE=RelWithDebInfo
make
</pre><p>The compiled executables should appear in this <code>build</code> directory along with the cnipol libraries.</p>
<h1>How to run cnipol </h1>
<p>Make sure the following environment variables are set to valid locations before running the cnipol executables </p>
<pre class="fragment">$CNIPOL_DATA_DIR
$CNIPOL_RESULTS_DIR
</pre><p><code>asym</code> accepts a number of options which can be listed by running it with a <code>-h</code> option. Here we just give a few most common examples used to process regular and calibration data.</p>
<p>To analyze a regular data file simply do: </p>
<pre class="fragment">asym -r &lt;meas_id&gt;
</pre><p>where <code>&lt;meas_id&gt;</code> is a unique name of a measurement, e.g. 12345.001. Note that usually <code>&lt;file_name&gt; = &lt;meas_id&gt;.data</code>. The program searches for the input &lt;file_name&gt; file in $CNIPOL_DATA_DIR and creates an output directory &lt;meas_id&gt; in $CNIPOL_RESULTS_DIR. Typically, the output directory contains a ROOT file with a predefined set of histograms, a log file (stdoe.log) with the entire output of the program, a PHP file with information about the measurement and results to display on the web, and a file with calibration results.</p>
<p>To analyze an alpha or pulser measurement use the &ndash;alpha option: </p>
<pre class="fragment">asym --alpha -r &lt;meas_id&gt;
</pre><h2>Batch processing multiple data files </h2>
<p>Once in a while, when, for example, the <b>cnipol</b> code is modified one may need to re-analyze a large number of data files. This can be achieved in several ways by utilizing common linux tools. Here for completeness we provide a simple shell script that takes a text file containing a list of measurements (one <code>&lt;meas_id&gt;</code> per line) as a single argument and starts a certain number of parallel jobs in the background. The scripts for energy calibration and regular runs can be executed respectively as: </p>
<pre class="fragment">script/run_asym_alpha.sh &lt;meas_list&gt;
script/run_asym.sh &lt;meas_list&gt;
</pre><h1>How to produce summary plots </h1>
<p>Often it is useful to see how polarization or other observables change from measurement to measurement during some period of time. To study such time dependence we developed <code>masym</code>, a program that runs on a set of measurements analyzed with <code>asym</code>. The output ROOT files produced by <code>asym</code> are used as input to <code>masym</code>. Executing the following command will create a <code>&lt;meas_list&gt;</code> directory in $CNIPOL_RESULTS_DIR with a ROOT file containing summary histograms: </p>
<pre class="fragment">masym -m &lt;meas_list&gt;
</pre><p>Here &lt;meas_list&gt; is a plain text file with a list of measurements to process. This file is assumed to exist in $CNIPOL_RESULTS_DIR/runXX/lists/ and to have one <code>&lt;meas_id&gt;</code> per line.</p>
<p>Optionally, the analyzer can provide a plain text file $CNIPOL_RESULTS_DIR/runXX/hjet_pol with H-Jet polarization values, and one file $CNIPOL_RESULTS_DIR/runXX/cdev_info/cdev_NNNNN per fill NNNNN containing intensity and other beam parameters. Information from these text files will be used by <code>masym</code> in the summary plots. Information from CDEV can be extracted using the following script on the acnlin CAD cluster: </p>
<pre class="fragment">$CNIPOL_DIR/script/get_fill_info.sh &lt;NNNNN&gt;
</pre><p>where &lt;NNNNN&gt; must be replaced with an actual fill number.</p>
<p>Similarly to <code>masym</code> we provide a program to study time dependences in a set of alpha-calibration measurements. This program is called <code>malpha</code> and can be invoked as: </p>
<pre class="fragment">malpha -m &lt;meas_list&gt;
</pre><p>where <code>&lt;meas_list&gt;</code> is a file in <code>$CNIPOL_RESULTS_DIR/runXX/lists/</code> with a list of unique names corresponding to measurements recorded by the polarimeters when no beam was present in the RHIC.</p>
<h1>Other polarimetry software packages </h1>
<p>Different people have been working on analysing polarimetry data. Some notable packages used for this purpose are:</p>
<table class="doxtable">
<tr>
<th>ags_cni </th><td><p class="starttd"></p>
<p>Code for AGS data analysis.</p>
<p></p>
<p>AGS has a jet polarimeter much like the one at RHIC. Analysis code has branched a long time ago and is now supported by CAD.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<th>hjet-analysis </th><td><p class="starttd"></p>
<p>Code for the H-jet polarimeter data analysis</p>
<p></p>
<p>Supported by the RHIC Spin group. As many other analyses it's reader code is based on the code found in <code>online/src/rdatautil.c</code>.</p>
<p class="endtd"></p>
</td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 3 2014 17:44:59 for cnipol by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
